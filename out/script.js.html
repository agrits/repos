<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: script.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: script.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
* Represents a repository
* @constructor
* @param {Object} obj - JSON object to be parsed
 */

class Repo{
  constructor(obj){
    Object.assign(this, obj)
  }
  /** Checks if repo was updated before given date*/
  wasUpdatedAfterDate = function(date) {
    date = new Date(date)
    return (new Date(this.updated_at)) >= date
  }
  /** Returns html representation of repository*/
  asHTMLElement = function(){
    var row = createRow()
    row.appendChild(createCell(this.owner.login))
    row.appendChild(createCell(this.name))
    row.appendChild(createCell(this.description))
    row.appendChild(createCell(this.updated_at))
    var a = createLink(this.clone_url)
    var aCell = createCell('')
    aCell.appendChild(a)
    row.appendChild(aCell)
    return row
  }
}

/** Creates header for repository table */
function createHeader(){
  columns = "Owner,Name,Description,Latest Update,Clone URL".split(",")
  tr = document.createElement("tr")
  columns.forEach(col =>
    tr.appendChild(createHeaderCell(col))
  )
  return tr
}

/** Creates header cell*/
function createHeaderCell(content){
  th = document.createElement("th")
  th.innerHTML = content
  return th
}

/** Create new row*/
function createRow(){
  tr = document.createElement("tr")
  return tr
}

/** Create new a tag with given content*/
function createLink(content){
  a = document.createElement("a")
  a.innerText = content
  a.href = content
  return a
}

/** Creates cell for given content */
function createCell(content){
  td = document.createElement("td")
  td.innerHTML = content
  return td
}

/** Renders all &lt;repos> tags*/
function renderRepos(){
  elements = document.getElementsByTagName("repos")
  Array.from(elements).forEach(el => {
    user = el.attributes['data-user'].textContent
    date = el.attributes['data-update'].textContent
    renderUserRepos(user, date, el)
  })
}

/** Render repositories of given user and switches element for rendered object*/
function renderUserRepos(user, date, element){
  table = document.createElement("table")
  table.setAttribute("id", user+"Table")
  fetch('https://api.github.com/users/'+user+'/repos')
    .then((response) => {
      return response.json();
    })
    .then((json) => {
      if("message" in json){
        row = createRow()
        row.appendChild(createCell(`Error while fetching: ${json.message}`))
      }
      else{
        table.appendChild(createHeader())
        json.map(obj => new Repo(obj))
            .filter(repo => repo.wasUpdatedAfterDate(date))
            .forEach(repo => {table.appendChild(repo.asHTMLElement())})
        element.parentNode.replaceChild(table, element)
      }
    })
    .catch((error) => {
      alert(`Can't fetch data for ${user}`)
      console.log(error)
    });
}

// Could also use 'defer' in HTML
document.addEventListener("DOMContentLoaded", function() {
  renderRepos()
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Repo.html">Repo</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createCell">createCell</a></li><li><a href="global.html#createHeader">createHeader</a></li><li><a href="global.html#createHeaderCell">createHeaderCell</a></li><li><a href="global.html#createLink">createLink</a></li><li><a href="global.html#createRow">createRow</a></li><li><a href="global.html#renderRepos">renderRepos</a></li><li><a href="global.html#renderUserRepos">renderUserRepos</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Fri Mar 20 2020 13:25:51 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
